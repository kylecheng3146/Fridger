# Fridger 健康儀表板功能規劃

## 1. 背景與目的
- Fridger 目前聚焦於庫存與賞味期管理，但缺乏將食材資訊轉化為飲食洞察的體驗。
- 透過健康儀表板，系統可提供營養比例、膳食多樣性等指標，協助使用者做出更健康的料理決策，進而提升產品黏著度與差異化。

## 2. 成功指標 (North Star + Supporting Metrics)
1. 儀表板觸達率：每週至少 40% 的活躍使用者瀏覽儀表板（7 日 DAU 基準）。
2. 建議互動率：瀏覽儀表板的使用者中，20% 有點擊建議食譜或補貨提示。
3. 過期食材比例下降：啟用儀表板的使用者，30 日內過期率下降 10%。
4. NPS 健康指標：詢問儀表板相關題時，平均滿意度達 4.2/5 以上。

## 3. 目標使用者與痛點
- **家庭主要採買者**：希望家人飲食均衡，但難以快速掌握冰箱內容與健康程度。
- **養生或健身族群**：關注蛋白質、蔬果攝取比例，需要客製化洞察。
- **共享冰箱/室友**：想協調誰應調整飲食與採購，缺乏整體視圖。

痛點：
- 冷雜、不知道冰箱裡哪些食材過多或過少。
- 缺乏即時提醒，常在蔬果不足或甜食過量時才後知後覺。
- 想吃得多樣化但沒有資料洞察引導。

## 4. 使用者故事 (MVP)
1. **作為** 家庭主煮  
   **我想要** 一進入 App 時就看到蔬果、蛋白質、精緻澱粉的比例指標  
   **因此** 我能快速知道這週的飲食是否失衡。
2. **作為** 養生族群  
   **我想要** 查看即將過期的高熱量品項與系統建議的處理方式  
   **因此** 我能安排餐點消耗掉並避免浪費。
3. **作為** 室友成員  
   **我想要** 看到最近一週每個人新增的食材類型及多樣性分數  
   **因此** 我們可以協調誰負責補齊缺少的品項。

## 5. 體驗流程 (主要情境)
1. **入口**：首頁新增「健康儀表板」卡片，顯示關鍵指標摘要（例如蔬果比例、即將過期警示）。點擊後進入完整儀表板頁。
2. **縮放邏輯**：
   - 儀表板的三個主區塊皆可「縮小/展開」。縮小時僅顯示對應的類別圖示（蔬果葉片、蛋白質肌肉、澱粉穀物等）與百分比文字；展開後才顯示詳細圖表、建議或趨勢。
   - 首屏預設僅展開指標區，建議與歷史區縮小，降低資訊負擔並鼓勵根據需求展開。
   - 每次縮小/展開皆記錄事件，後續可分析常用視圖與資訊優先順序。
3. **指標區塊**：
   - 營養比例圓環圖（蔬果 / 蛋白質 / 澱粉 / 其他）。
   - 膳食多樣性指數（以近 7 日食材類型數量計算）。
   - 過期風險清單（按熱量、糖分分類，高風險項目突出顯示）。
4. **建議區塊**：
   - 系統推薦「本週可嘗試的食譜」或「建議增加的食材類別」。
   - 一鍵將食材加入購物清單或跳轉到現有食譜模組。
5. **通知與提醒**：當指標低於門檻（例如蔬果占比 < 30%）時推送一次提醒，並在儀表板上強調。

## 6. 功能需求拆解
### 前端
- 新增首頁卡片組件，支援動態指標與點擊跳轉。
- 建立「健康儀表板」頁面，包含三個區塊：指標、建議、歷史趨勢，可縮小/展開。
- 縮小狀態需顯示圖示與百分比：每個指標搭配固定圖示、百分比字樣，以及狀態色（綠 / 黃 / 紅）提示。
- 儀表板需記憶使用者上次的縮放狀態並於下次載入時還原，提升個人化效率。
- 指標圖表可使用現有圖表元件或引入輕量圖表庫；需支援空狀態與資料更新動畫。
- 推播/通知中心內新增健康提醒類別，並連結至儀表板。
- 需回報縮放行為與各區塊展開時長以供後續優化資訊架構。

### 後端與資料
- 定義食材分類與營養標籤（蔬菜、水果、蛋白質、精緻澱粉、其他），可復用既有分類或擴充。
- 排程每日計算每位使用者的指標：比例、多樣性分數、過期風險清單。
- 建立建議引擎 MVP：根據缺乏的食材類別或即將過期的品項，匹配簡短建議文案與食譜 ID。
- 儲存儀表板瀏覽事件與建議點擊事件供日後分析。

### 分析與資料科學 (後續迭代)
- 使用匿名化資料持續調整多樣性演算法，並探索個人化建議。
- 與營養師合作定義加權標準或健康等級，增加權威性。

## 7. 依賴與假設
- 已有的食材分類資料需完整；若使用者自訂品項，需有 fallback 規則或請使用者補分類。
- 需要推播服務或站內通知系統，以便提醒指標异常。
- 食譜模組已可被呼叫與參數化；若未完成則需優先排程。

## 8. 風險與緩解
| 風險 | 影響 | 緩解策略 |
| --- | --- | --- |
| 食材分類缺失造成指標不準 | 儀表板可信度下降 | MVP 先限定在有標準分類的品項，並在 UI 顯示「X% 未分類」提示 |
| 使用者被指標淹沒 | 使用者退縮、不再查看 | 儀表板採階層式資訊架構，僅顯示 3 個核心指標，其餘可展開 |
| 推播過多造成反感 | 取消提醒 | 設定頻率上限（每週最多 2 則），並提供關閉開關 |

## 9. 里程碑與交付
1. **需求鎖定 (Week 1)**：完成指標定義、資料需求、API 規格。
2. **資料管線 & 後端 (Week 2-3)**：實作分類、指標計算、建議引擎雛形。
3. **前端 UI & 互動 (Week 3-4)**：完成首頁卡片與儀表板頁，串接假資料進行可用性測試。
4. **整合測試 & Beta (Week 5)**：小範圍開放，收集指標準確性與互動率。
5. **正式發版 (Week 6)**：根據 Beta 回饋微調指標與建議內容，對全體使用者開啟。

## 10. 未來迭代方向
- 引入個人目標設定（例如每日蛋白質目標），儀表板可對照實際庫存差異。
- 與穿戴裝置或卡路里追蹤 App 整合，提供現實攝取與庫存的閉環。
- 建立社群挑戰（例如「一週五色蔬果挑戰」）增加趣味性與互動。

## 11. UX 與資料後續行動

### 11.1 縮小狀態圖示 / 色碼對齊
- **圖示語彙**：延續品牌指南中的「圓潤、易辨識」原則。建議以 24px filled icon（葉片、肌肉手臂、麥穗、沙漏、閃電等）搭配 12px 文案，間距 8px，確保縮小狀態也能一秒識別指標類別。
- **色碼建議**（含 WCAG AA 對比檢核）：

| 指標狀態 | 色碼 | 使用情境 | 對比需求 |
| --- | --- | --- | --- |
| 良好 | `#2D5A27` (Forest) | 占比 ≥ 40% 或風險低 | 與米白背景 `#F9F9F9` 的亮度對比 6.2:1，通過 AA。 |
| 需注意 | `#FF9800` (Warm Orange) | 占比 25-39% 或預警 | 與背景對比 3.5:1；縮小狀態搭配深灰文案 `#37474F` 一起呈現。 |
| 緊急 | `#E53935` (Chili Red) | 占比 < 25% 或高風險 | 對比 4.8:1，需搭配白色圖示/文字避免費力。 |

- **圖示 mapping**（待與設計確認最終樣式）：

| 指標 | 圖示建議 | 象徵含義 | 補充說明 |
| --- | --- | --- | --- |
| 蔬果比例 | 葉片/芽苗 | 新鮮、自然 | 可沿用庫存卡片的蔬菜 icon 保持一致。 |
| 蛋白質 | 手臂/豆類 | 力量、飽足 | 避免肉塊過度寫實，保持簡化線條。 |
| 澱粉/精緻碳水 | 麥穗/飯碗 | 能量來源 | 若使用飯碗 icon，建議加入線條暗示碳水。 |
| 多樣性指數 | 棱鏡/色輪 | 多元組成 | 可使用五色扇形 icon；縮小時僅保留輪廓。 |
| 過期風險 | 沙漏/計時器 | 時間緊迫 | 缺省狀態使用灰色，警示時切換紅色填滿。 |

- **可用性檢查**：與設計師同步以下檢核表  
  1. Icon 在 16px、24px、32px 下是否仍清楚辨識。  
  2. 百分比文字與 icon 的顏色對比達 AA。  
  3. 缩小狀態若同時顯示 3 個指標，是否維持 4px 以上的 touch padding。  
  4. 多語系（中/英）字數不同時是否仍能保持齊排。

### 11.2 縮放狀態儲存與事件回傳
- **狀態儲存策略**：
  - 客端（App Storage）：使用 key `health-dashboard:sectionState`，紀錄每個區塊的 `expanded|collapsed`；可快速還原使用者偏好。
  - 後端（選擇性）：當使用者登入同步時，將最新狀態寫至使用者設定 `user_preferences.healthDashboard`，方便跨裝置維持一致體驗。
  - 沒有偏好資料時的預設：指標區展開、建議/歷史縮小。
- **事件定義**（供資料/後端對齊）：

| 事件 ID | 觸發時機 | Payload | 用途 |
| --- | --- | --- | --- |
| `health_dash_section_toggle` | 使用者縮小或展開任一區塊 | `section_id`, `action`, `previous_state`, `timestamp` | 分析熱門區塊、確認預設是否合理。 |
| `health_dash_collapsed_view_impression` | 載入縮小狀態且停留 ≥1.5s | `section_id`, `state_duration`, `is_default` | 觀測縮小卡是否被真正閱讀。 |
| `health_dash_state_sync` | 客端將狀態寫回後端 | `section_state`, `source` (app/desktop) | 調查跨裝置一致性需求。 |

- **資料流程**：
  1. 前端在 `onToggle` 時即時更新本地狀態並送出事件（節流 500ms）。  
  2. 每次成功同步（登入或設定檔更新）後僅上傳變動的區塊，避免多餘寫入。  
  3. 若後端狀態與本地不同，以「最新時間戳」決定最終值。  
  4. 數據團隊可根據事件建立 Looker dashboard：觀察縮小/展開轉換率、最常使用的視圖等，迭代資訊架構。
